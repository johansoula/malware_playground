#!/usr/bin/env python

import re
import requests
import sys
import os


def virusshare_fetch(fname, i):
    url = "http://virusshare.com/hashes/VirusShare_%s.md5" % i

    r = requests.get(url, stream = True)
    if r.status_code != 200:
        return False

    with open(fname, 'aw') as fd:                      
        chunk_size  = 8192                         
        for chunk in r.iter_content(chunk_size):
            fd.write(chunk)
        fd.close
    return True



def virusshare_fetch_all(fname):
    for i in range(0, 99999):
        print i
        if not virusshare_fetch(fname, "%05d" % i):
            break


virusshare_fetch_all("virusshare_hashlist.csv")

